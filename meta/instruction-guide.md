# 명령문 작성 및 검증 가이드

이 문서는 명령문(`.md` 파일)을 **작성**하고 **검증**하는 통합 가이드입니다.

---

## 핵심 원칙

**"사용자가 명령문을 잘 기억해서 잘 명령하는 게 아니라, AI가 명령문을 잘 기억하고 사용자를 잘 리드하는 것"**

좋은 명령문은:
- AI가 사용자를 주도적으로 안내
- AI가 잘못된 요청을 제지하고 더 나은 방법 제안 (역제안)
- 사용자는 완벽히 기억할 필요 없음, AI가 대신 기억

**관련 커밋**: `ac4df05`, `9826aa9`, `6bffa451`

---

## 명령문 작성 템플릿

새로운 명령문을 작성할 때 아래 구조를 따르세요.

**기준**: [`instructions/workflow/README.md`](../instructions/workflow/README.md)의 구조를 표준으로 채택

### 1. 개요 [필수]

이 명령문의 목적과 사용 상황을 명확히 설명합니다.

**작성 가이드**:
- 어떤 문제를 해결하기 위한 명령문인가?
- 어떤 상황에서 사용하는가?
- 사용자가 어떤 키워드로 이 명령문을 찾게 되는가?

**공통 원칙이 있는 경우**:
```markdown
> **공통 원칙은 [`common.md`](링크)를 참고하세요.**
```

### 2. AI 행동 가이드 [필수]

AI가 이 명령문을 받았을 때 어떻게 행동해야 하는지 명시합니다.

#### 2.1. 배경 지식 [선택]

AI가 작업을 수행하기 위해 알아야 할 도메인 지식이나 컨텍스트를 명시합니다.

**예시**:
```markdown
### 배경 지식

원본 문서(구글 문서)는 다음 패턴으로 작성되어 있습니다:
- **영어**: 공식 문서 인용
- **한글**: 사용자의 해석 및 보충
- **이미지**: Gemini 캡처, 공식 문서 다이어그램
```

#### 2.2. 시작 전 준비 [선택]

사전에 필요한 정보 수집이나 컨텍스트 로딩이 있다면 명시합니다.

**예시**:
- "레포지토리 Context 정보 수집: `template/context-setup.md` 양식에 맞춰 사용자로부터 정보 수집"
- "다음 파일들을 먼저 읽으세요: X, Y, Z"

#### 2.3. 진행 방식

AI가 따라야 할 단계와 순서를 명시합니다.

**작성 가이드**:
- 순차적 단계가 있다면 명확히 나열
- 각 단계에서 사용자 승인이 필요한지 명시
- 자동으로 진행 vs 대기 지점 구분
- 필요시 별도 파일로 분리하고 링크

#### 2.4. [CRITICAL] 지켜야 할 원칙 [선택]

AI가 **반드시** 지켜야 할 원칙이 있다면 명시합니다.

**작성 가이드**:
- 사용자 승인 대기가 필요한가? 아니면 자동으로 끝까지 진행해도 되는가?
- 절대 금지 사항이 있는가?
- 우선순위 규칙이 있는가?

#### 2.5. 추가 안내 패턴 [선택]

다른 섹션(배경 지식, 시작 전 준비, 진행 방식, CRITICAL 원칙)에서 이미 안내한 내용은 여기에 중복하지 마세요.

**이 섹션은 다른 섹션에서 다루지 않은 추가 안내가 있을 때만 작성합니다.**

**작성 가이드**:
- 어떤 시점에 사용자에게 선택지를 제시할 것인가?
- 다음 단계를 어떻게 안내할 것인가?
- 사용자가 잘못 요청할 수 있는 케이스가 있는가?
- AI가 검증해야 할 항목이 있는가?
- 예시 포함 (❌ 나쁜 예 vs ✅ 좋은 예)

**예시 (workflow에서):**

사용자가 다음에 무엇을 해야 할지 막막해하지 않도록 AI가 선택지를 제시합니다.

```markdown
## [AI 필수] commit-sequence.md 작성 완료 후 안내

> "commit-sequence.md 작성 완료했습니다.
>
> **다음 Step으로 넘어가기 전 확인사항**:
> □ 각 커밋의 의존 관계가 명확한가요?
> □ 순서가 논리적으로 맞나요?
>
> **[중요] 다음 Step 진행 방식**:
> ⚠️ Task Detail을 한번에 모두 만들지 마세요!
>
> **추천 방식**:
> 1. commit-sequence를 그룹으로 나눠서 진행
> 2. 첫 그룹만 Task Detail 작성
> 3. 작성한 것부터 커밋으로 구현
>
> 전체 커밋이 N개인데, 먼저 어떤 그룹부터 시작할까요?"
```

**패턴 2: 역제안 (잘못된 요청 제지)**

사용자가 잘못된 방향으로 가려 할 때 AI가 제지하고 대안을 제시합니다.

예시 (review-work에서):
```markdown
❌ **나쁜 예:**
- 사용자: "지난 3개월 커밋 분석해줘"
- AI: "네, 분석하겠습니다"

✅ **좋은 예:**
- 사용자: "지난 3개월 커밋 분석해줘"
- AI: "3개월은 범위가 너무 넓습니다. 일일 회고는 하루 단위로 진행하는 것이 효과적입니다. 특정 날짜나 최근 1일을 분석할까요?"
```

**패턴 3: AI가 먼저 생각 제시 → 사용자 의견 구하기**

예시 (workflow에서):
```markdown
❌ **나쁜 예:**
- "background.md를 작성했습니다." (그리고 바로 다음 단계 진행)

✅ **좋은 예:**
- "제가 파악한 문제와 배경은 이렇습니다. 사용자님은 어떻게 생각하시나요?" (멈추고 대기)
- "시킨 방식 A도 가능하지만, B가 더 나은 이유는... 어떻게 생각하시나요?"
```

**관련 커밋**: `ac4df05` (workflow 절차 사이사이마다 사용자에게 안내하는 문구 추가)

### 3. 출력 형식 [선택]

결과물의 구조가 정해져 있는 경우 명시합니다.

**예시**:
- 리포트 구조
- 문서 템플릿
- 커밋 메시지 형식
- 파일 저장 경로

### 4. 참고 자료 [선택]

출처, 관련 문서, 외부 링크 등을 기재합니다.

**예시**:
```markdown
## 출처
- [대기업 기술면접 준비 가이드](https://www.youtube.com/watch?v=x__FGE5UNe8)
- [카카오엔터테인먼트 문제 해결을 넘어](https://tech.kakaoent.com/...)
```

---

## 중복 방지 가이드

### 1. 같은 파일 내 섹션 중복 방지

같은 내용을 여러 섹션에서 반복하지 마세요.

**❌ 나쁜 예:**
```markdown
### 진행 방식
1. Step 1 - 사전 검증
2. Step 2 - PDF 읽기
3. Step 3 - 템플릿 매핑

## Step별 상세 내용
### Step 1. 사전 검증
...
### Step 2. PDF 읽기
...
```
→ "진행 방식"과 "Step별 상세"에서 Step 목록이 중복됨

**✅ 좋은 예 1: 상세 내용이 많은 경우 - 별도 파일로 분리**
```markdown
### 진행 방식
- [step-1.md](steps/step-1.md) - 사전 검증
- [step-2.md](steps/step-2.md) - PDF 읽기
```
→ workflow/README.md 패턴

**❌ 나쁜 예 2: 별도 섹션이 특정 Step에 종속**
```markdown
## 템플릿 매핑 규칙
[상세 내용...]

## 이미지 처리
[상세 내용...]

## Step별 상세 내용
### Step 3. 템플릿 매핑
- [ ] Questions 추출
- [ ] 이미지 처리
```
→ "템플릿 매핑 규칙", "이미지 처리"가 Step 3에서만 필요한데 별도 섹션으로 분리

**✅ 좋은 예 3: Step에 종속되는 내용은 하위 섹션으로 통합**
```markdown
## Step별 상세 내용

### Step 3. 템플릿 매핑
- [ ] Questions 추출
- [ ] 이미지 처리

#### 3-1. 매핑 규칙
[템플릿 매핑 규칙 내용]

#### 3-2. 이미지 처리
[이미지 처리 내용]
```
→ Step 3에서만 필요한 내용은 Step 3의 하위 섹션으로

---

## 사용법

### 명령문 작성 시
위의 "명령문 작성 템플릿" 구조를 따라 작성합니다.

### 명령문 검증 시
"명령문 검증 체크리스트"를 기준으로 검증하고, 문제점과 개선안을 제시합니다.

**검증 요청 예시**:
```
"[파일명] 검증해줘"
"이 명령문 audit 해줘"
```
