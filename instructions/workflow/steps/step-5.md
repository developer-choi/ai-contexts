# Step 5: 상세 명세 작성 (Task Refinement)

이 단계는 `/plan/commit-sequence.md`에 정의된 각 커밋 단위 작업을 구체화하여 **최종 개발 명세서**를 완성하는 단계입니다.

> **[roadmap](instructions/self-help/roadmap.md) 연결**: 4단계 - 구현의 여정
>
> 선택한 기술을 실제로 어떻게 적용했는지 설명합니다.
> - **구현 상세**: 구체적으로 어떻게 코드로 구현했는가?
> - **기술적 난관**: 구현 과정에서 마주친 엣지 케이스나 예상치 못한 문제는 무엇이었는가?

각 커밋에 대한 **상세 명세서**를 `/plan/tasks/` 폴더 아래에 생성해주세요.

**파일 명명 규칙**: `/plan/tasks/[순서]-[작업키워드].md` (예: `/plan/tasks/01-feat-button.md`)

---

## [CRITICAL] 필수 준수 사항

### 1. 진행 상황 동기화 (commit-sequence.md 업데이트)
- **상세 내용 삭제, 제목 유지**: 특정 커밋에 대한 상세 명세서(`tasks/*.md`) 작성이 완료되면, `/plan/commit-sequence.md`에서 해당 항목의 **하위 상세 작업 내용은 즉시 삭제**하세요.
- **제목(커밋 메시지)은 유지**: 어떤 단계의 설계가 완료되었는지 시각적으로 알 수 있도록 제목 라인만 남겨둡니다.

**업데이트 예시 (`commit-sequence.md`)**:

**❌ Bad (상세 내용이 그대로 남은 경우)**
```markdown
- [feat]: 네이티브 브릿지 타입 정의
  - 브릿지 메시지 타입 정의 (권한, 모달 정보)
  - 모달 닫힌 정보 타입 정의 (종류, 시각)
```

**✅ Good (상세 설계 완료 후 제목만 남기세요)**
```markdown
- [feat]: 네이티브 브릿지 타입 정의
```

### 2. 상세 스펙 작성 원칙 (로직 중심, 코드 배제)
로딩, 성공, 실패, 엣지 (목록없음 등) 명세 필수

### 3. 문서의 일회성
- **커밋 후 가치 소멸**: 해당 PR을 작성하기 위한 **임시 설계도**입니다.
- **최신화 불필요**: 코드가 커밋(`git commit`)된 이후에는, 실제 코드가 Source of Truth가 됩니다. 나중에 로직이 변경되더라도 이 문서를 다시 열어 수정(동기화)하지 마세요.

---

## 공통 작성 항목 (모든 작업 필수)

모든 작업 명세서는 다음 항목들을 반드시 포함해야 합니다.

### 1. 개요
- **작업 파일**: 생성 또는 수정할 파일의 경로 (예: `src/components/.../FileName.tsx`)
- **목적**: 이 작업이 왜 필요한지 세 줄 미만 요약.

### 2. 참고 자료
- 작업의 근거가 되는 문서 및 기존 코드를 링크합니다.
- **필수 포함**: `/plan/background.md`, `/plan/codebase-audit.md`, `/plan/overview.md`, `/plan/commit-sequence.md`
- **추가 포함**: 관련된 기존 컴포넌트, 유틸리티, 또는 참고할 커밋 링크.

### 3. 예상 영향 범위 리스트업 << 너무 많다? 그럼 이 PR이 큰것 ㅇㅇ. 그러니 PR 다시 쪼개야한다는 신호.
- **수정되는 파일**: 기존 코드를 수정해야 한다면 해당 파일 목록.
- **의존 관계**: 이 작업이 다른 컴포넌트/함수에 미치는 영향.

---

## [AI 필수] Task Detail 작성 완료 시 안내

3-5개의 Task Detail 작성을 완료할 때마다 사용자에게 물어보세요:

> "Task 1, 2, 3, 4, 5 명세 작성 완료했습니다.
>
> **작성한 Task Detail 문서들을 모두 읽고 이해하셨나요?**
> - `/plan/tasks/01-xxx.md`
> - `/plan/tasks/02-xxx.md`
> - ...
>
> - 구현해야 할 내용이 명확한가요?
> - 이해가 안 되거나 불필요한 내용이 있나요?
>
> ⚠️ **Task Detail을 충분히 이해하지 못한 상태에서 구현하면, 잘못된 코드가 작성됩니다.**
>
> **이해가 안 되거나 불필요한 내용이 있다면 지금 수정하고 넘어가야 합니다.**
>
> **다음 선택지**:
> - A. 이 5개를 먼저 커밋으로 구현하기 (추천)
> - B. 아직 옮기지 못한 commit-sequence 항목을 Task Detail 문서로 옮기기
>
> 어떻게 진행할까요?"

---

// TODO overview.md의 안내사항이랑 잘 합쳐야.
## [AI 필수] 커밋 완료 후 안내

각 그룹의 커밋 구현이 완료될 때마다 사용자에게 다음과 같이 안내하세요:

> "Task 1, 2, 3, 4, 5 구현 완료했습니다.
>
> **🔍 AI 구현 코드 리뷰 필수**:
>
> ⚠️ **구현된 코드를 반드시 확인하고 이해해야 합니다.**
>
> - AI가 작성한 커밋에는 **분명 잘못 구현된 부분이 있을 수 있습니다**
> - **지금 반드시 리뷰해주세요:**
>   - Task Detail이 기획서와 다르게 작성되어 잘못된 구현이 있나요?
>   - 구현된 코드가 Task Detail과 다르게 작성되지 않았나요?
>   - 구현된 코드의 로직을 이해하셨나요?
>   - 이해가 안 되거나 잘못된 부분이 있나요?
>
> - **IDE의 "Compare with Local" 기능**을 사용하면 전체 변경사항을 한눈에 볼 수 있습니다
>   - Squash로 합치기 전에 변경사항 전체를 확인하는 게 Conflict가 덜 나고 좋습니다.
>
> ⚠️ **코드를 충분히 이해하지 못한 상태에서 다음으로 넘어가면, 나중에 디버깅이나 기능 추가 시 문제가 됩니다.**
>
> **📁 Task Detail 문서 정리**:
> 구현 완료된 Task Detail 문서(`tasks/task-001.md` 등)는 이제 임시 문서로 역할이 끝났습니다.
> - 기존 Task Detail 읽어보시고 **코드로 옮겨진 내용은 삭제하는 게 좋습니다**
> - 완전히 삭제해도 됩니다 (코드가 source of truth)
> - 또는 참고용으로 남겨둬도 됩니다
>
> **진행 상황**:
> - 완료: Task 1~5 (5개)
> - 남음: commit-sequence 6~15번 (10개)
>
> **다음 그룹 제안**:
> 다음은 6~10번 (Hook 관련)을 진행하면 좋을 것 같은데, 어떻게 생각하세요?
>
> **구현 중 문제 발견 시 대응**:
> - 순서 변경 필요: 코드에 바로 반영 (Task Detail 수정 X, 역주행 금지 원칙)
> - 추가 작업 필요: 즉시 커밋 추가 vs commit-sequence 업데이트 중 선택
> - Task Detail과 다르게 구현해야 함: Task Detail은 stale 상태로 두고 코드에 반영