# Step 4: 구현 방침 상세화 (Implementation Guidelines)

> **⚠️ 이 단계는 Step 3에서 기술 전략이 확정된 후에 진행합니다.**
>
> Step 3에서 선택지 비교와 최종 선택이 사용자에게 승인되면,
> 이 단계에서 선택된 기술의 **구체적인 구현 방침**을 작성합니다.

---

## 작성 목적

Step 3에서는 "무엇을(What) 선택할 것인가"를 결정했습니다.
이 단계에서는 "어떻게(How) 구현할 것인가"의 큰 그림을 그립니다.

**AI가 코드 작성 시 이 문서를 기반으로**:
- 로딩/성공/실패/엣지 케이스 대응 방법 파악
- 영향 범위를 확인하여 안전한 구현
- 중요한 비즈니스 로직 누락 방지

---

## 추가할 내용

`/plan/overview.md` 양식은 매번 바뀔 수 있으므로 적절한 필기 위치를 찾아서 아래 내용을 추가해주세요.

```markdown
**구현 방침**:
- **기본 흐름**: [핵심 처리 흐름을 3-5단계로 요약]
- **성공/실패/엣지 케이스**: [각 상황별 대응 방법]
- **중요한 비즈니스 로직**: [재노출 기준, 권한 체크 시점 등]
- **수정/추가 파일**: [구체적인 파일 경로 목록]
```

예시:
```markdown
**구현 방침**:
- **기본 흐름**: 기존 ConfirmModal 재사용, 네이티브 브릿지 API로 권한 확인
- **권한 GRANTED**: toggleNotification API 호출 → 성공 토스트 → 모달 닫기
- **권한 거부/미설정**: 설정 유도 모달(NotificationPermissionModal) 오픈
- **API 실패**: 에러 토스트 노출, 모달은 유지 (재시도 가능)
- **재노출 로직**: localStorage에 마지막 닫은 시각 저장, 2주(14일) 후 재노출
- **수정/추가 파일**:
  - `src/pages/EventPage.tsx` (독려 모달 통합)
  - `src/pages/NoticePage.tsx` (독려 모달 통합)
  - `src/hooks/useNotificationModal.ts` (새로 생성)
```

---

## 작성 원칙

### 써야 할 것

- **상태별 대응**: 로딩, 성공, 실패, 엣지 케이스를 어떻게 처리할지
- **핵심 흐름**: 3-5단계로 요약한 큰 흐름
- **수정/추가할 파일 목록**: 이번 PR에서 건드릴 파일 경로 리스트
- **중요한 비즈니스 로직**: 2주 재노출 기준, 권한 체크 시점 등
- **중요한 분기점**: 언제 어떤 조건으로 분기하는지

### 쓰지 않을 것

- Props 타입 상세 정의 (`title: string, onClose: () => void`)
- 변수명/함수명
- 10단계 이상의 상세 로직 (5단계 이내로 요약)
- 에러 메시지 문구
- 스타일링 가이드 (CSS, tailwind 클래스 등)
- 데이터 포맷 (날짜 포맷 등)

---

## [CRITICAL] 중복 내용 검증

**구현 방침 작성 완료 후, 작성된 overview.md에 대해 중복 검증을 수행하세요.**

### 검증 절차

1. **중복 검사 항목**
   - **Step 3 vs Step 4 중복**: "3. 핵심 기술적 과제 및 기술 전략"에서 이미 설명한 내용을 "4. 각 과제별 구현 방침"에서 반복하고 있지 않은가?
   - **과제 간 중복**: 여러 과제에 같은 내용이 복사-붙여넣기 되어 있지 않은가?
   - **불필요한 상세**: 이 단계의 "쓰지 않을 것" 목록에 있는 내용이 작성되어 있지 않은가?

2. **문제 발견 시 대응**
   - 중복이나 불필요한 내용을 발견하면 **즉시 사용자에게 경고**하세요.
   - 발견된 문제를 구체적으로 설명하고, 해결 방안(특정 instructions/workflow/*.md 가이드 개선)을 제안하세요.
   - 사용자의 결정을 기다리세요.

3. **문제가 없으면**
   - 중복 검증 통과 후 다음 섹션으로 진행

---

## [CRITICAL] PR 분할 재검토

**구현 방침을 구체화하면서 작업량이 많아 보이면, PR을 더 쪼개야 한다는 신호입니다.**

### AI의 판단 기준

다음 상황이 발생하면 PR 분할을 제안하세요:

- 예상 커밋 수가 **8개 이상**으로 보일 때
- 수정/추가 파일 목록이 **10개 이상**일 때
- 서로 독립적인 기능이 하나의 PR에 묶여 있을 때

### AI의 제안 방식

> "야 이거 작업량이 너무 많은 것 같은데 한번 봐봐요.
>
> - 수정/추가 파일: [N]개
> - 예상 커밋: [M]개 정도
>
> 너무 많다 싶으면 PR 분할하는 게 좋을 것 같아요. 어떻게 생각하세요?"

사용자가 동의하면 Step 2(PR 분할 전략 수립)로 돌아가서 `project.md`를 업데이트하고, 현재 PR의 범위를 축소한 `overview.md`를 다시 작성하세요.

---

## [CRITICAL] 다음 단계로 넘어가기 전 필수 확인

**⚠️ overview.md 구현 방침 추가를 완료한 후, 다음 단계(구현)로 넘어가기 전에 사용자 확인이 필요합니다.**

### AI의 필수 질문 (다음 단계 진행 전)

overview.md에 구현 방침을 추가한 후, 사용자에게 다음과 같이 물어보세요:

> "overview.md에 구현 방침을 추가했습니다.
>
> 다음 단계(구현)로 넘어가기 전에 확인이 필요합니다.
>
> **추가된 구현 방침을 읽고 이해하셨나요?**
> - 각 과제의 로딩/성공/실패/엣지 케이스 대응이 명확한가요?
> - 영향 범위가 적절한가요?
> - 이해가 안 되거나 불필요한 내용이 있나요?
>
> ⚠️ **구현 방침을 충분히 이해하지 못한 상태에서 구현을 시작하면, 잘못된 코드 작성으로 이어집니다.**
>
> **이해가 안 되거나 불필요한 내용이 있다면 지금 수정하고 넘어가야 합니다.**
>
> 모든 내용을 이해하셨다면 승인해주세요. 구현을 시작하겠습니다."
