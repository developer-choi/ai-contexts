# Step 2: PR 분할 전략 수립

여러 PR로 나뉠 수 있는 큰 작업의 분할 전략을 수립합니다.

---

## [CRITICAL] 레거시 코드 영향도 분석 (선택적)

> **Codebase Audit을 수행하기로 한 경우**, plan mode로 진행하세요. 모듈 간 의존성과 파일 구조를 AI가 직접 탐색하여 더 정확한 분석이 가능합니다.

전략 수립 전 기존 코드 분석이 필요한지 사용자에게 제안하세요:

> "기존 코드를 분석해서 계획을 더 정확하게 만들까요? (토큰이 더 들긴 합니다.)
> 분석이 필요하다면 **어느 파일이나 폴더**를 알려주세요."

- **위치를 알려준 경우**: `/plan/codebase-audit.md` 작성 ([📄 템플릿](../template/codebase-audit.md))
  - 가용 자원 탐색 (이미 구현된 것 찾기)
  - 수정 위치 특정 (어느 파일 어느 라인)
  - 중복 방지 (재사용 방법 고민)
- **필요 없다고 한 경우**: 이 단계를 건너뛰고 바로 '작업 크기 판단'으로 넘어가세요

---

## [CRITICAL] 작업 크기 판단

- **작은 작업** (커밋 3개 이하): 이 단계 건너뛰고 다음 단계로
- **큰 작업** (커밋 4개 이상, 또는 여러 도메인 포함): PR 분할 전략 수립

AI는 작업이 작다고 판단되면 제안하세요:
> "이 작업은 약 [N]개의 커밋으로 예상됩니다. 단일 PR로 진행하고 이 단계를 건너뛸까요?"

---

## [CRITICAL] 진행 원칙

**한 번에 하나의 PR, 하나의 구체적인 기능**만 다룹니다.
- 하나의 `/plan/pr{N}/overview.md` = 하나의 PR

---

## PR 분할 전략 수립

### 기획 점검 (TODO 식별)

PR 분할 초안을 작성한 뒤, 각 PR별로 사용자에게 확인합니다:

> "각 PR에 미리 남겨둘 TODO가 있으신가요?
> 예: 'PR #3 시작 전에 디자이너에게 모달 시안 확인', 'PR #5에서 결제 API 키 발급 필요' 등
>
> 특정 PR에 해당하는 것이 아니라면 전체 TODO로 남겨도 됩니다."

답변은 `/plan/project.md`의 해당 PR 항목에 TODO로 기록합니다.

### PR 분할 원칙
1. **의존성 순서**: 공통 모듈 → 개별 페이지

**기술적 과제는 다음 단계에서 다룹니다.** 이 단계는 PR 분할에만 집중하세요.

---

## 작성 양식 (`/plan/project.md`)

```markdown
## PR 분할 전략

### PR #1: 네이티브 브릿지 API
**범위:**
- 알림 권한 상태 조회 API
- 알림 권한 요청 트리거 API

**기획 확인 필요 (TODO):**
- [ ] iOS/Android 권한 거부 시 에러 코드 확인
- [ ] 권한 요청 팝업 문구 확정

### PR #2: 공통 모달 컴포넌트
(위와 동일)
```

**핵심:**
- `project.md`는 전체 프로젝트 동안 유지
- `overview.md`는 각 PR 디렉토리(`/plan/pr{N}/`)에 생성

---

## [CRITICAL] 사용자 확인 필수

작성 완료 후 사용자에게 확인 요청:

> "PR 분할 전략 수립 완료.
>
> 다음 문서들을 이해하셨나요?
> - `/plan/codebase-audit.md` (작성한 경우)
> - `/plan/project.md` (작성한 경우)
>
> ⚠️ **이해 안 되는 부분이 있으면 지금 수정해야 합니다.**
>
> 이해하셨으면 승인해주세요."
